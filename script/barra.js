(function($){$.extend({placeholder:{settings:{focusClass:"placeholderFocus",activeClass:"placeholder",overrideSupport:false,preventRefreshIssues:true},debug:false,log:function(msg){if(!$.placeholder.debug)return;msg="[Placeholder] "+msg;$.placeholder.hasFirebug?console.log(msg):$.placeholder.hasConsoleLog?window.console.log(msg):alert(msg)},hasFirebug:"console"in window&&"firebug"in window.console,hasConsoleLog:"console"in window&&"log"in window.console}});$.support.placeholder="placeholder"in document.createElement("input");
$.fn.plVal=$.fn.val;$.fn.val=function(value){$.placeholder.log("in val");if(this[0]){$.placeholder.log("have found an element");var el=$(this[0]);if(value!=undefined){$.placeholder.log("in setter");var currentValue=el.plVal();var returnValue=$(this).plVal(value);if(el.hasClass($.placeholder.settings.activeClass)&&currentValue==el.attr("placeholder"))el.removeClass($.placeholder.settings.activeClass);return returnValue}if(el.hasClass($.placeholder.settings.activeClass)&&el.plVal()==el.attr("placeholder")){$.placeholder.log("returning empty because its a placeholder");
return""}else{$.placeholder.log("returning original val");return el.plVal()}}$.placeholder.log("returning undefined");return undefined};$(window).bind("beforeunload.placeholder",function(){var els=$("input.placeholderActive");if(els.length>0)els.val("").attr("autocomplete","off")});$.fn.placeholder=function(opts){opts=$.extend({},$.placeholder.settings,opts);if(!opts.overrideSupport&&$.support.placeholder)return this;return this.each(function(){var $el=$(this);if(!$el.is("[placeholder]"))return;if($el.is(":password"))return;
if(opts.preventRefreshIssues)$el.attr("autocomplete","off");$el.bind("focus.placeholder",function(){var $el=$(this);if(this.value==$el.attr("placeholder")&&$el.hasClass(opts.activeClass))$el.val("").removeClass(opts.activeClass).addClass(opts.focusClass)});$el.bind("blur.placeholder",function(){var $el=$(this);$el.removeClass(opts.focusClass);if(this.value=="")$el.val($el.attr("placeholder")).addClass(opts.activeClass)});$el.triggerHandler("blur");$el.parents("form").submit(function(){$el.triggerHandler("focus.placeholder")})})}})(jQuery);
$(document).ready(function(){if(getDB("jappix-mini","dom")){$("div.bar").remove();launchMini(true,false,getDB("jappix-mini-login","domain"),getDB("jappix-mini-login","xid"),getDB("jappix-mini-login","pwd"))}else resetDB();$("input").placeholder();$("input.password_false").focus(function(){$(this).hide();$("input.password_real").show().focus()});$("input.password_real").blur(function(){if(!$(this).val()){$(this).hide();$("input.password_false").show().placeholder()}});$("#login_account").submit(function(){try{var xid=
trim($(this).find("input[name=xid]").val());var pwd=trim($(this).find("input[name=pwd]").val());if(!xid||!pwd)return false;if(xid.match(/([^@]+)@?([^@]+)?/)){var username=RegExp.$1;var domain=RegExp.$2}if(!domain)domain="chatme.im";$("div.bar").fadeOut("normal",function(){$(this).remove()});MINI_ANIMATE=true;MINI_GROUPCHATS=["piazza"];setDB("jappix-mini-login","domain",domain);setDB("jappix-mini-login","xid",xid);setDB("jappix-mini-login","pwd",pwd);launchMini(true,true,domain,username,pwd)}catch(e){}finally{return false}});
$("#login_anonymous").submit(function(){try{var domain="anonymous.chatme.im";var nick=trim($(this).find("input[name=nick]").val());var room=trim($(this).find("input[name=room]").val());if(!nick||!room)return false;$("div.bar").fadeOut("normal",function(){$(this).remove()});MINI_ANIMATE=true;MINI_NICKNAME=nick;MINI_GROUPCHATS=[room];setDB("jappix-mini-login","domain",domain);launchMini(true,true,domain)}catch(e){}finally{return false}})});
